[pytest]
markers =
    normalization: Camada de estabilização e limpesa textual pesada 
    validation: Validações fiscais e algorítmicas
    audit: Testes para auditoria fiscal e compliance

    e2e: Testes de pipeline completo
    robustez: Testes de resiliência e edge cases
    quality: Testes de qualidade de payload
    routing: Testes de decisões de roteamento

    contract: Testes de contrato de schema/payload
    payload_transform: Testes de transformação de payload
    api_contract: Contrato com FastAPI endpoints
    erp_contract: Contrato com sistemas ERP
    analytics_contract: Contrato com dados analíticos

    # Performance
    benchmark: Testes de performance e throughput
    latency: Testes de latência por operação
    memory: Testes de consumo de memória
    concurrency: Testes de processamento concorrente 

    integration: Testes de integração entre componentes
    redis: Testes com Redis
    database: Teste com PostgreSQL
    s3: Testes com S3/MinIO

    event_source: Testes de event sourcing e rastreabilidade

    slow: Testes que demoram mais de 1 segundo


addopts=
    -V
    --tb=short
    --strict-markers
    -W default::UserWarning
    --cov-report=term-missing
    --cov-report=html
    --durations=10
    --maxfail=5
    -p no:warnings

testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

[coverage:run]
source = robot
omit = 
    */tests/*
    */venv/*/*
    */__pycache__.py

[coverage:report]
precision = 2
skip_empty = True
exclude_lines = 
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:

timeout = 300
timeout_method = thread